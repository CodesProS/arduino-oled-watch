#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SH1106.h>
#include "RTClib.h"

RTC_DS3231 rtc;

#define OLED_RESET 4
Adafruit_SH1106 display(OLED_RESET);

static const unsigned char PROGMEM toparrow[] =
  { B11111111,B11111111,B11111111,B11111111,B11110000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM bottomarrow[] =
  { B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,B00000000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B10000000,B00000000,B00000000,B00000000,B00010000,
  B11111111,B11111111,B11111111,B11111111,B11110000,
  };
  static const unsigned char PROGMEM speaker[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00110000,B00000000,
  B00000000,B00000000,B01011000,B00010000,
  B00000000,B00000000,B11001000,B00001000,
  B00000000,B00000001,B11000100,B00000100,
  B00000000,B00000011,B11000100,B00110010,
  B00000000,B00000111,B11000010,B00010010,
  B00000000,B00001111,B11000010,B11001001,
  B00000000,B00111111,B11000001,B01001001,
  B00000000,B01111111,B11001101,B00101001,
  B00000001,B11111111,B11001101,B00101001,
  B00000111,B11111111,B11101101,B01001001,
  B00111111,B11111111,B11100000,B10001001,
  B11111111,B11111111,B11100000,B10000010,
  B11111111,B11111111,B11110000,B10000010,
  B11111111,B11111111,B11110000,B10000000,
  B11111111,B11111111,B11111000,B10000000,
  B01111111,B00000111,B11111000,B10000000,
  B00011111,B00000000,B00011101,B00000000,
  B00001111,B10000000,B00000011,B00000000,
  B00000111,B10000000,B00000000,B00000000,
  B00000011,B11000000,B00000000,B00000000,
  B00000011,B11100000,B00000000,B00000000,
  B00000001,B11100000,B00000000,B00000000,
  B00000000,B11000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM alarm[] =
  { B00000000,B11110000,B00001111,B00000000,
  B00000011,B11111000,B00011111,B11000000,
  B00000111,B11100000,B00000111,B11100000,
  B00001111,B10001111,B11110001,B11110000,
  B00011110,B00111111,B11111100,B01111000,
  B00011100,B11110001,B00001111,B00111000,
  B00011001,B11000001,B10000011,B10011000,
  B00000011,B00000001,B10000000,B11000000,
  B00000110,B00000001,B10000000,B01100000,
  B00001100,B00000001,B10000000,B00110000,
  B00011000,B00000001,B10000000,B00011000,
  B00011000,B00000001,B10000000,B00011000,
  B00110000,B00000001,B10000000,B00001100,
  B00110000,B00000001,B10000000,B00001100,
  B00110000,B00000001,B10000000,B00001100,
  B00100000,B00000001,B10000000,B00000100,
  B01100111,B11111111,B10000000,B00000110,
  B01111111,B11111111,B10000000,B00011110,
  B01100000,B00000000,B00000000,B00000110,
  B00100000,B00000000,B00000000,B00000100,
  B00110000,B00000000,B00000000,B00001100,
  B00110000,B00000000,B00000000,B00001100,
  B00110000,B00000000,B00000000,B00001100,
  B00011000,B00000000,B00000000,B00011000,
  B00011000,B00000000,B00000000,B00011000,
  B00001100,B00000000,B00000000,B00110000,
  B00000110,B00000000,B00000000,B01100000,
  B00000011,B00000000,B00000000,B11000000,
  B00000001,B11000001,B00000011,B10000000,
  B00000000,B11110001,B00001111,B00000000,
  B00000000,B00111111,B11111100,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  };
  static const unsigned char PROGMEM torch[] =
  { B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000111,B11100000,
  B00000000,B00000000,B00011111,B11100011,
  B00111111,B11111111,B11111111,B11101110,
  B01111111,B11111111,B11111111,B11101000,
  B11111111,B11111111,B11111111,B11100000,
  B11111111,B11111111,B11111111,B11101111,
  B11111111,B11111111,B11111111,B11101111,
  B11111111,B11111111,B11111111,B11100000,
  B01111111,B11111111,B11111111,B11101000,
  B00111111,B11111111,B11111111,B11101110,
  B00000000,B00000000,B00011111,B11100011,
  B00000000,B00000000,B00000111,B11100000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM stopwatch[] =
  { B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00001100,B00001111,B11110000,B00110000,
  B00011110,B00111111,B11111100,B01111000,
  B00111111,B11110001,B00001111,B11111100,
  B00111111,B11000001,B10000011,B11111100,
  B00011111,B00100001,B10000100,B11111000,
  B00001110,B00000001,B10000000,B01110000,
  B00001100,B00000001,B10000000,B00110000,
  B00011000,B00000001,B10000000,B00011000,
  B00011000,B00000001,B10000000,B00011000,
  B00110100,B00000001,B10000000,B00101100,
  B00110000,B00000001,B10000000,B00001100,
  B00110000,B00000001,B10000000,B00001100,
  B00100000,B00000001,B10000000,B00000100,
  B01100000,B00000001,B10000000,B00000110,
  B01111000,B00000001,B11000000,B00011110,
  B01100000,B00000000,B11100000,B00000110,
  B00100000,B00000000,B01110000,B00000100,
  B00110000,B00000000,B00111000,B00001100,
  B00110000,B00000000,B00011100,B00001100,
  B00110100,B00000000,B00001110,B00101100,
  B00011000,B00000000,B00000111,B00011000,
  B00011000,B00000000,B00000011,B00011000,
  B00001100,B00000000,B00000000,B00110000,
  B00000110,B00000000,B00000000,B01100000,
  B00000011,B00100000,B00000100,B11000000,
  B00000001,B11000001,B00000011,B10000000,
  B00000000,B11110001,B00001111,B00000000,
  B00000000,B00111111,B11111100,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  };
  static const unsigned char PROGMEM setting[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000010,B00000011,B11000000,B01000000,
  B00000111,B10000111,B11100001,B11100000,
  B00001111,B11011111,B11111011,B11110000,
  B00000111,B11111111,B11111111,B11100000,
  B00000111,B11111000,B00011111,B11100000,
  B00000011,B11100000,B00000111,B11000000,
  B00000001,B11000111,B11100011,B10000000,
  B00000011,B10001111,B11110001,B11000000,
  B00000011,B10011111,B11111001,B11000000,
  B00000111,B00111110,B01111100,B11100000,
  B01111111,B00111100,B00111100,B11111110,
  B01111111,B00111000,B00011100,B11111110,
  B01111111,B00111000,B00011100,B11111110,
  B01111111,B00111100,B00111100,B11111110,
  B00000111,B00111110,B01111100,B11100000,
  B00000011,B10011111,B11111001,B11000000,
  B00000011,B10001111,B11110001,B11000000,
  B00000001,B11000111,B11100011,B10000000,
  B00000011,B11100000,B00000111,B11000000,
  B00000111,B11111000,B00011111,B11100000,
  B00000111,B11111111,B11111111,B11100000,
  B00001111,B11011111,B11111011,B11110000,
  B00000111,B10000111,B11100001,B11100000,
  B00000010,B00000011,B11000000,B01000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM game[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00001111,B10000000,B00000001,B11110000,
  B00001111,B10000000,B00000001,B11110000,
  B00001111,B10000000,B00000001,B11110000,
  B00011111,B11111111,B11111111,B11111000,
  B00111001,B11111111,B11111111,B10011100,
  B00111001,B11111111,B11111111,B10011100,
  B01100000,B01111111,B11111110,B01100110,
  B01100000,B01111111,B11111110,B01100110,
  B01111001,B11111111,B11111111,B10011110,
  B01111001,B11001111,B11110011,B10011110,
  B01111111,B10000111,B11100001,B11111110,
  B01111111,B10110111,B11101101,B11111110,
  B11111111,B10000111,B11100001,B11111111,
  B11111111,B11001100,B00110011,B11111111,
  B11111111,B01111000,B00011110,B11111111,
  B11111110,B00000000,B00000000,B01111111,
  B11111100,B00000000,B00000000,B00111111,
  B01111000,B00000000,B00000000,B00011110,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM small[] =
  {B00110011,B00000000,
  B01011110,B10000000,
  B00000000,B00000000,
  B01000000,B10000000,
  B00000000,B00000000,
  B10111000,B01000000,
  B00000000,B00000000,
  B01000000,B10000000,
  B00100001,B00000000,
  B00011110,B00000000,
  };
  static const unsigned char PROGMEM exits[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00111111,B11111111,B11111000,B00000000,
  B01111111,B11111111,B11111100,B00000000,
  B01110000,B00000000,B00011100,B00000000,
  B01100000,B00000000,B00001100,B00000000,
  B01100000,B00000000,B00001100,B11000000,
  B01100000,B00000000,B00001100,B11100000,
  B01100000,B00000000,B00000000,B01110000,
  B01100000,B00000000,B00000000,B00111000,
  B01100000,B00000000,B00000000,B00011100,
  B01100000,B00000000,B11111111,B11111110,
  B01100000,B00000000,B11111111,B11111110,
  B01100000,B00000000,B00000000,B00011100,
  B01100000,B00000000,B00000000,B00111000,
  B01100000,B00000000,B00000000,B01110000,
  B01100000,B00000000,B00001100,B11100000,
  B01100000,B00000000,B00001100,B11000000,
  B01100000,B00000000,B00001100,B00000000,
  B01110000,B00000000,B00011100,B00000000,
  B01111111,B11111111,B11111100,B00000000,
  B00111111,B11111111,B11111000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM rotates[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00011111,B11111000,B00000000,
  B00000000,B01111111,B11111110,B00000000,
  B00000000,B11111111,B11111111,B00000000,
  B00000001,B11111111,B11111110,B00000000,
  B00000011,B11111111,B11111110,B00000000,
  B00000111,B11111000,B00011100,B11000000,
  B00000111,B11100000,B00001001,B11100000,
  B00001111,B11000000,B00000011,B11110000,
  B00001111,B11000000,B00000111,B11111000,
  B00001111,B10000000,B00000111,B11111100,
  B00001111,B10000000,B00001111,B11111110,
  B11111111,B11110000,B00010011,B11110000,
  B01111111,B11110000,B00000001,B11110000,
  B00111111,B11100000,B00000011,B11110000,
  B00011111,B11000000,B00000011,B11110000,
  B00001111,B10000000,B00000111,B11100000,
  B00000111,B00010000,B00001111,B11100000,
  B00000010,B00111000,B00111111,B11000000,
  B00000000,B01111111,B11111111,B11000000,
  B00000000,B11111111,B11111111,B10000000,
  B00000000,B11111111,B11111111,B00000000,
  B00000000,B01111111,B11111100,B00000000,
  B00000000,B00011111,B11110000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };

  static const unsigned char PROGMEM brightness3[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000110,B00000001,B10000000,B01100000,
  B00000111,B00000001,B10000000,B11100000,
  B00000011,B10000001,B10000001,B11000000,
  B00000001,B11000000,B00000011,B10000000,
  B00000000,B11000000,B00000011,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  B00000000,B00011111,B11111000,B00000000,
  B00000000,B00011100,B00111000,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B01111111,B00111000,B00011100,B11111110,
  B01111111,B00111000,B00011100,B11111110,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00011100,B00111000,B00000000,
  B00000000,B00011111,B11111000,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B11000000,B00000011,B00000000,
  B00000001,B11000000,B00000011,B10000000,
  B00000011,B10000001,B10000001,B11000000,
  B00000111,B00000001,B10000000,B11100000,
  B00000110,B00000001,B10000000,B01100000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };


  static const unsigned char PROGMEM displays[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000111,B11111111,B11111111,B11000000,
  B00001111,B11111111,B11111111,B11110000,
  B00011111,B11111111,B11111111,B11110000,
  B00011111,B11111111,B11111111,B11110000,
  B00011110,B00000000,B00000000,B11110000,
  B00011110,B00000000,B00000000,B01110000,
  B00011110,B00000000,B00000000,B01110000,
  B00011110,B01100000,B00000000,B01110000,
  B00011110,B11110000,B00000000,B01110000,
  B00011110,B11110000,B00000000,B01110000,
  B00011110,B01100000,B00000000,B01110000,
  B00011110,B00000000,B11000000,B01110000,
  B00011110,B00000001,B01100000,B01110000,
  B00011110,B00000010,B11110000,B01110000,
  B00011110,B00111011,B11111000,B01110000,
  B00011110,B01011101,B11111100,B01110000,
  B00011110,B11111110,B11111110,B01110000,
  B00011110,B00000000,B00000000,B01110000,
  B00011110,B00000000,B00000000,B01110000,
  B00011110,B00000000,B00000000,B11110000,
  B00011111,B11111111,B11111111,B11110000,
  B00011111,B11111111,B11111111,B11110000,
  B00001111,B11111111,B11111111,B11110000,
  B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM vibration[] =
  {
  B00000001,B11000000,B00000000,B00000000,
  B00000110,B00000000,B00000000,B00000000,
  B00011000,B00000000,B00000000,B00000000,
  B00100011,B10000001,B11000000,B00000000,
  B01100100,B00000110,B00100000,B00000000,
  B01001000,B00110000,B00100000,B00000000,
  B10010000,B11000000,B00010000,B00000000,
  B10010010,B00000000,B00010000,B00000000,
  B10010010,B00000000,B00000000,B00000000,
  B10000010,B10000000,B00001000,B00000000,
  B00000010,B00000000,B00001000,B00000000,
  B00000001,B00000000,B00000100,B00000000,
  B00000001,B00000000,B00000100,B00000000,
  B00000000,B00000000,B00000010,B00000000,
  B00000000,B10000000,B00000010,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B01000000,B00000001,B00000000,
  B00000000,B01000000,B00000001,B00000000,
  B00000000,B00100000,B00000000,B10000000,
  B00000000,B00100000,B00000000,B10000010,
  B00000000,B00000000,B00000000,B00000001,
  B00000000,B00010000,B00000000,B01001001,
  B00000000,B00010000,B00000000,B11000101,
  B00000000,B00001000,B00000000,B00100101,
  B00000000,B00001000,B00000000,B00100101,
  B00000000,B00000000,B00010000,B11001001,
  B00000000,B00000100,B00000111,B00001010,
  B00000000,B00000100,B00011000,B00010010,
  B00000000,B00000010,B01100000,B00100100,
  B00000000,B00000001,B10000000,B00001100,
  B00000000,B00000000,B00000000,B00011000,
  B00000000,B00000000,B00000000,B00100000,
  };  
  static const unsigned char PROGMEM screencolor[] =
  {B11111111,B11111111,B11111111,B11111111,
  B11111111,B11111111,B11111111,B11111111,
  B11111111,B11111111,B11111111,B11111111,
  B11111111,B11111111,B11111111,B11111111,
  B11111000,B00000000,B00000000,B00001111,
  B11111100,B00000000,B00000000,B00001111,
  B11111110,B00000000,B00000000,B00001111,
  B11111111,B00000000,B00000000,B00001111,
  B11111111,B10000000,B00000000,B00001111,
  B11111111,B11000000,B00000000,B00001111,
  B11111111,B11111111,B11111100,B00001111,
  B11111111,B11011111,B11111100,B00001111,
  B11111111,B11001111,B11111100,B00001111,
  B11111111,B11000111,B11111100,B00001111,
  B11111111,B11000011,B11111100,B00001111,
  B11111111,B11000001,B11111100,B00001111,
  B11111111,B11000000,B11111100,B00001111,
  B11111111,B11000000,B01111100,B00001111,
  B11111111,B11000000,B00111100,B00001111,
  B11111111,B11000000,B00011100,B00001111,
  B11111111,B11000000,B00001100,B00001111,
  B11111111,B11000000,B00000100,B00001111,
  B11111111,B11111111,B11111110,B00001111,
  B11111111,B11111111,B11111111,B00001111,
  B11111111,B11111111,B11111111,B10001111,
  B11111111,B11111111,B11111111,B11001111,
  B11111111,B11111111,B11111111,B11101111,
  B11111111,B11111111,B11111111,B11111111,
  B11111111,B11111111,B11111111,B11111111,
  B11111111,B11111111,B11111111,B11111111,
  B11111111,B11111111,B11111111,B11111111,
  B11111111,B11111111,B11111111,B11111111,
  };

  static const unsigned char PROGMEM brightness1[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000001,B10000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  B00000000,B00011111,B11111000,B00000000,
  B00000000,B00011100,B00111000,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00011100,B00111000,B00000000,
  B00000000,B00011111,B11111000,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B11000000,B00000011,B00000000,
  B00000001,B11000000,B00000011,B10000000,
  B00000011,B10000000,B00000001,B11000000,
  B00000111,B00000000,B00000000,B11100000,
  B00000110,B00000000,B00000000,B01100000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };
  static const unsigned char PROGMEM brightness2[] =
  {B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000110,B00000000,B00000000,B01100000,
  B00000111,B00000000,B00000000,B11100000,
  B00000011,B10000000,B00000001,B11000000,
  B00000001,B11000000,B00000011,B10000000,
  B00000000,B11000000,B00000011,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  B00000000,B00011111,B11111000,B00000000,
  B00000000,B00011100,B00111000,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00111000,B00011100,B00000000,
  B00000000,B00011100,B00111000,B00000000,
  B00000000,B00011111,B11111000,B00000000,
  B00000000,B00001111,B11110000,B00000000,
  B00000000,B00000011,B11000000,B00000000,
  B00000000,B11000000,B00000011,B00000000,
  B00000001,B11000000,B00000011,B10000000,
  B00000011,B10000000,B00000001,B11000000,
  B00000111,B00000000,B00000000,B11100000,
  B00000110,B00000000,B00000000,B01100000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  B00000000,B00000000,B00000000,B00000000,
  };

  static const unsigned char PROGMEM player[] =
  { 
    B00000000, B11110000,
    B00000000, B11110000,
    B00000001, B11111000,
    B00000000, B11010000,
    B00000000, B11111000,
    B00000000, B11110000,
    B00000000, B01100000,
    B00000000, B11110000,
    B00000001, B11111000,
    B00000011, B11111100,
    B00000111, B11111110,
    B00000110, B11110110,
    B00000000, B11111000,
    B00000001, B11011010,
    B00000011, B00001110,
    B00000011, B00001100 
  };

  static const unsigned char PROGMEM cloud[] =
  {
    B00000000,B10000000,
    B00011111,B00000000,
    B00010001,B10000000,
    B00100010,B01000000,
    B01100100,B01100000,
    B10000100,B00010000,
    B10001000,B00010000,
    B10010000,B00010000,
    B01011111,B11100000,
    B00100000,B00000000,
  };


enum Mode {
  MODE_MAIN_MENU      = 0,   // Main menu with icons
  MODE_SETTINGS       = 1,   // Settings menu
  MODE_DISPLAY_MENU   = 2,   // Display settings menu

  MODE_STOPWATCH_RUN  = 9,   // Stopwatch running
  MODE_STOPWATCH_PAUSE= 10,  // Stopwatch paused

  MODE_TORCH_MENU     = 13,  // Torch menu
  MODE_TORCH_R_STEP1  = 17,  // Red torch low
  MODE_TORCH_R_STEP2  = 18,  // Red torch medium
  MODE_TORCH_R_STEP3  = 19,  // Red torch high

  MODE_SLEEP          = 20,  // Sleep screen

  MODE_GAMES_MENU     = 30,  // Games menu
  MODE_GAME_FLAPPY    = 35,  // Flappy game

  MODE_DISPLAY_STYLE  = 50,  // Brightness / color / rotate

  MODE_ALARM_MENU     = 60,  // Alarm set menu

  MODE_TORCH_W_STEP1  = 71,  // White torch low
  MODE_TORCH_W_STEP2  = 72,  // White torch medium
  MODE_TORCH_W_STEP3  = 73,  // White torch high
  MODE_LASER          = 75,  // Laser

  MODE_ALARM_RING     = 110, // Alarm ringing
  MODE_VOL_ALARM      = 121, // Alarm volume
  MODE_VOL_GENERAL    = 122, // General volume

  MODE_CLOCK          = 100, // Clock screen (kept at end for clarity)
  MODE_HALT           = 160  // Halt / do nothing
};

Mode mode = MODE_CLOCK;

int a = 0;
int b = 0;
int alarmIconPos = 27;
int color = 1;
int gh = 4;
int hij = 0;

// Main menu icon positions
int torchPos = 81;
int stopwatchPos = 135;
int settingPos = 189;
int gamePos = 243;
int exitIconPos = 297;

int x = 0;
int epos = 27;
int zrpos = 27;
int zrpos2 = 81;
int zrpos3 = 135;
int zrpos4 = 189;
int epos2 = 81;
int cpos = 27;
int cpos2 = 81;
int cpos3 = 135;
int cpos4 = 189;
int cpos5 = 243;
int cpos6 = 297;
int y = 0;
int al = 0;
int dpos = 27;
int dpos2 = 81;
int dpos3 = 135;
int dpos4 = 189;
int dpos5 = 243;
int fpos = 27;
int fpos2 = 81;
int z = 0;
int pos = 15;
int hu = 0;
int gpos = 17;
int gpos2 = 35;
int gpos3 = 61;
int gpos4 = 79;
int ipos = 0;
int ipos2 = 19;
int ipos3 = 46;
int ipos4 = 65;
int ce = 0;
int slepout = 0;
int deduce = 54;

int rotation = 0;
int stmil = 0;
int stmin = 0;
int pos10 = -20;
int inten = 0;
int stsec = 0;
int stpos = 0;
int yo = 0;
int st = 0;
int hi = 0;
int ad = 0;
int i = 0;

int minutes,days,hours,months,seconds,years = 0;
int period = 1000;
int hr = 0;
int mins = 0;
int sec = 0;
int ghpos = 17;
int ghpos2 = 35;
int ghpos3 = 61;
int ghpos4 = 79;
int ghpos5 = 96;

char daysOfTheWeek[7][12] = {"SUNDAY", "MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY"};

long startTime = millis(), startTime2 = millis();

byte jumping;
int sc;
byte died = false;
byte started = false;
byte started2 = false;
long score = 0;
int time;
int ru = 0;
int light = 0;
int pos1 = 0;
int zero = 0;
int six = 0;
int his = 0;
int timer = 0;
int eight = 0;
int atu = 0;
int jpos = -20;
int jpos2 = 0;
int soundf = 255;
int soundpos6 = 10;
int soundpos16 = 10;
int soundg = 255;
int men = 0;


void setup() {
  pinMode(3, OUTPUT);   // torch W
  pinMode(5, OUTPUT);   // torch R
  pinMode(4, OUTPUT);   // laser or LED on 4
  pinMode(9, OUTPUT);   // buzzer/speaker
  pinMode(10, OUTPUT);  // buzzer/speaker

  display.begin(SH1106_SWITCHCAPVCC, 0x3C);
  display.setRotation(rotation);
  display.clearDisplay();
  display.display();
  delay(2000);

  pinMode(16, INPUT_PULLUP);
  pinMode(17, INPUT_PULLUP);
  pinMode(14, INPUT_PULLUP);
  pinMode(15, OUTPUT);

  rtc.begin();
}

void loop() {
  switch (mode) {
    case MODE_CLOCK:
      handleClockScreen();
      break;

    case MODE_MAIN_MENU:
      handleMainMenu();
      break;

    case MODE_SETTINGS:
      displaySettings();
      break;

    case MODE_VOL_ALARM:
      controlAlarmVolume();
      break;

    case MODE_VOL_GENERAL:
      controlVolumeSettings();
      break;

    case MODE_DISPLAY_MENU:
      handleDisplayMenu();
      break;

    case MODE_DISPLAY_STYLE:
      showDisplayMenu();
      break;

    case MODE_STOPWATCH_RUN:
      handleStopwatchRun();
      break;

    case MODE_STOPWATCH_PAUSE:
      handleStopwatchPause();
      break;

    case MODE_TORCH_MENU:
      handleTorchMenu();
      break;

    case MODE_TORCH_R_STEP1:
      handleRedTorchStep1();
      break;

    case MODE_TORCH_R_STEP2:
      handleRedTorchStep2();
      break;

    case MODE_TORCH_R_STEP3:
      handleRedTorchStep3();
      break;

    case MODE_TORCH_W_STEP1:
      handleWhiteTorchStep1();
      break;

    case MODE_TORCH_W_STEP2:
      handleWhiteTorchStep2();
      break;

    case MODE_TORCH_W_STEP3:
      handleWhiteTorchStep3();
      break;

    case MODE_LASER:
      handleLaserMode();
      break;

    case MODE_GAMES_MENU:
      handleGamesMenu();
      break;

    case MODE_GAME_FLAPPY:
      handleFlappyGame();
      break;

    case MODE_ALARM_MENU:
      handleAlarmMenu();
      break;

    case MODE_SLEEP:
      handleSleepMode();
      break;

    case MODE_ALARM_RING:
      handleAlarmRinging();
      break;

    case MODE_HALT:
     
      break;
  }
}

void handleClockScreen() {
  tim();
  ala();
  dis();
  sleep();
  if (digitalRead(16) == LOW) {
    delay(130);
    display.clearDisplay();
    mode = MODE_MAIN_MENU;
  }
}

void handleMainMenu() {
  display.clearDisplay();
  menu();
  ala();
  sleep();
  display.drawBitmap(alarmIconPos, 20, alarm, 32, 32, color);
  display.drawBitmap(torchPos, 20, torch, 32, 32, color);
  display.drawBitmap(stopwatchPos, 20, stopwatch, 32, 32, color);
  display.drawBitmap(settingPos, 20, setting, 32, 32, color);
  display.drawBitmap(gamePos, 20, game, 32, 32, color);
  display.drawBitmap(exitIconPos, 20, exits, 32, 32, color);
  display.display();

  if (digitalRead(16) == LOW) {
    delay(130);
    x++;
    alarmIconPos   -= deduce;
    torchPos       -= deduce;
    stopwatchPos   -= deduce;
    settingPos     -= deduce;
    gamePos        -= deduce;
    exitIconPos    -= deduce;
    display.display();
  }

  if (x > 5) {
    alarmIconPos = 27;
    torchPos     = 81;
    stopwatchPos = 135;
    settingPos   = 189;
    gamePos      = 243;
    exitIconPos  = 297;
    x = 0;
    display.display();
  }

  if ((x == 3) && (digitalRead(17) == LOW)) { // Settings
    delay(130);
    cpos = 27; cpos2 = 81; cpos3 = 135; cpos4 = 189; cpos5 = 243; cpos6 = 297;
    y = 0;
    display.clearDisplay();
    mode = MODE_SETTINGS;
  }

  if ((x == 2) && (digitalRead(17) == LOW)) { // Stopwatch
    delay(130);
    display.clearDisplay();
    mode = MODE_STOPWATCH_RUN;
  }

  if ((x == 0) && (digitalRead(17) == LOW)) { // Alarm menu
    display.clearDisplay();
    mode = MODE_ALARM_MENU;
  }

  if ((x == 4) && (digitalRead(17) == LOW)) { // Games
    display.clearDisplay();
    mode = MODE_GAMES_MENU;
  }

  if ((x == 1) && (digitalRead(17) == LOW)) { // Torch
    display.clearDisplay();
    mode = MODE_TORCH_MENU;
  }

  if ((x == 5) && (digitalRead(17) == LOW)) { // Exit -> Clock
    display.clearDisplay();
    mode = MODE_CLOCK;
  }
}

void displaySettings() {
  menu();
  ala();
  sleep();
  display.drawBitmap(cpos,  20, speaker,   32, 32, color);
  display.drawBitmap(cpos2, 20, displays,  32, 25, color);
  display.drawBitmap(cpos3, 20, vibration, 32, 32, color);
  display.drawBitmap(cpos4, 20, exits,     32, 32, color);
  display.display();

  if (digitalRead(16) == LOW) {
    delay(130);
    y++;
    cpos  -= deduce;
    cpos2 -= deduce;
    cpos3 -= deduce;
    cpos4 -= deduce;
    display.display();
  }

  if (y > 3) {
    cpos = 27; cpos2 = 81; cpos3 = 135; cpos4 = 189;
    y = 0;
    display.display();
  }

  if ((y == 0) && (digitalRead(17) == LOW)) { // Alarm volume
    delay(130);
    display.clearDisplay();
    display.display();
    mode = MODE_VOL_ALARM;
  }

  if ((y == 2) && (digitalRead(17) == LOW)) { // General volume
    delay(130);
    display.clearDisplay();
    mode = MODE_VOL_GENERAL;
  }

  if ((y == 3) && (digitalRead(17) == LOW)) { // Back
    delay(130);
    mode = MODE_MAIN_MENU;
  }

  if ((y == 1) && (digitalRead(17) == LOW)) { // Display menu
    dpos = 27; dpos2 = 81; dpos3 = 144; dpos4 = 189; dpos5 = 243;
    z = 0;
    display.clearDisplay();
    y = 0;
    mode = MODE_DISPLAY_MENU;
  }
}

void controlAlarmVolume() {
  ala();
  speakers();
  display.setTextSize(1);;
  display.setTextColor(color);
  display.setCursor(0, soundpos6);
  display.println(">");
  display.display();

  if (digitalRead(16) == LOW) {
    delay(130);
    display.clearDisplay();
    soundpos6 += 10;
    display.display();
  }

  if ((soundpos6 == 10) && (digitalRead(17) == LOW)) {
    delay(130);
    soundf = 0;
    mode = MODE_SETTINGS;
  }
  if ((soundpos6 == 20) && (digitalRead(17) == LOW)) {
    delay(130);
    soundf = 20;
    mode = MODE_SETTINGS;
  }
  if ((soundpos6 == 30) && (digitalRead(17) == LOW)) {
    delay(130);
    soundf = 120;
    mode = MODE_SETTINGS;
  }
  if ((soundpos6 == 40) && (digitalRead(17) == LOW)) {
    delay(130);
    soundf = 255;
    mode = MODE_SETTINGS;
  }
  if ((soundpos6 == 50) && (digitalRead(17) == LOW)) {
    delay(130);
    mode = MODE_SETTINGS;
  }
  if (soundpos6 > 50) {
    display.clearDisplay();
    soundpos6 = 10;
    display.display();
  }
}

void controlVolumeSettings() {
  ala();
  speakers();
  display.setTextSize(1);;
  display.setTextColor(color);
  display.setCursor(0, soundpos16);
  display.println(">");
  display.display();

  if (digitalRead(16) == LOW) {
    delay(130);
    display.clearDisplay();
    soundpos16 += 10;
    display.display();
  }

  if ((soundpos16 == 10) && (digitalRead(17) == LOW)) {
    delay(130);
    soundg = 0;
    mode = MODE_SETTINGS;
  }
  if ((soundpos16 == 20) && (digitalRead(17) == LOW)) {
    delay(130);
    soundg = 20;
    mode = MODE_SETTINGS;
  }
  if ((soundpos16 == 30) && (digitalRead(17) == LOW)) {
    delay(130);
    soundg = 120;
    mode = MODE_SETTINGS;
  }
  if ((soundpos16 == 40) && (digitalRead(17) == LOW)) {
    delay(130);
    soundg = 255;
    mode = MODE_SETTINGS;
  }
  if ((soundpos16 == 50) && (digitalRead(17) == LOW)) {
    delay(130);
    mode = MODE_SETTINGS;
  }
  if (soundpos16 > 50) {
    display.clearDisplay();
    soundpos16 = 10;
    display.display();
  }
}

void handleDisplayMenu() {
  menu_dis();
  ala();
  sleep();

  if (digitalRead(16) == LOW) {
    delay(130);
    z++;
    dpos  -= deduce;
    dpos2 -= deduce;
    dpos3 -= deduce;
    dpos4 -= deduce;
    display.display();
  }

  if (z > 3) {
    dpos = 27; dpos2 = 81; dpos3 = 135; dpos4 = 189;
    z = 0;
    display.display();
  }

  if ((z == 3) && (digitalRead(17) == LOW)) {
    delay(130);
    display.clearDisplay();
    mode = MODE_SETTINGS;
    z = 0; y = 0;
    cpos = 27; cpos2 = 81; cpos3 = 135; cpos4 = 189; cpos5 = 243; cpos6 = 297;
  }

  if ((z == 2) && (digitalRead(17) == LOW)) {
    delay(150);
    rotation++;
    display.setRotation(rotation);
  }

  if ((z == 1) && (digitalRead(17) == LOW)) {
    mode = MODE_DISPLAY_STYLE;
    display.clearDisplay();
  }
}

void showDisplayMenu() {
  color = 0;
  ala();
  blacke();
  display.drawBitmap(dpos,  20, brightness3, 32, 32, color);
  display.drawBitmap(dpos2, 20, screencolor, 32, 32, color);
  display.drawBitmap(dpos3, 20, rotates,    32, 32, color);
  display.drawBitmap(dpos4, 20, exits,      32, 32, color);
  display.display();

  if (digitalRead(16) == LOW) {
    delay(130);
    z++;
    dpos  -= deduce;
    dpos2 -= deduce;
    dpos3 -= deduce;
    dpos4 -= deduce;
    dpos5 -= deduce;
    display.display();
  }

  if (digitalRead(14) == LOW) {
    delay(130);
    mode = MODE_DISPLAY_MENU;
    color = 1;
  }
}

void handleStopwatchRun() {
  ala();
  displayStopWatch();
  pauseStopwatch();
  stope();

  if (digitalRead(14) == LOW) {
    delay(130);
    display.display();
    mode = MODE_STOPWATCH_PAUSE;
  }
  if (stsec >= 10) {
    display.display();
    ipos3 = -20;
    ipos4 = 46;
  }
  if (stmin >= 10) {
    display.display();
    ipos  = -20;
    ipos2 = 0;
  }
  if (stsec < 10) {
    display.display();
    ipos3 = 46;
    ipos4 = 65;
  }
  if (stmin < 10) {
    display.display();
    ipos  = 0;
    ipos2 = 19;
  }
  if (stsec > 59) {
    display.display();
    stsec = 0;
    stmin++;
  }
  delay(1000);
  display.clearDisplay();
  stsec++;
}

void handleStopwatchPause() {
  ala();
  displayStopWatch();
  stopwatch3();
  stope();
  if (digitalRead(14) == LOW) {
    delay(130);
    display.display();
    mode = MODE_STOPWATCH_RUN;
  }
}

void handleTorchMenu() {
  ala();
  display.setTextColor(color);
  display.setTextSize(2);
  display.setCursor(12, 0);
  display.println("Torch W");
  display.setCursor(12, 15);
  display.println("Torch R");
  display.setCursor(13, 30);
  display.println("Laser");
  display.setCursor(0, pos1);
  display.println(">");
  display.setCursor(12, 45);
  display.println("Back");
  display.display();

  if (digitalRead(16) == LOW) {
    delay(130);
    pos1 += 15;
    display.clearDisplay();
    display.display();
  }

  if ((pos1 == 0) && (digitalRead(14) == LOW)) {
    delay(130);
    display.clearDisplay();
    mode = MODE_TORCH_W_STEP1;
  }
  if ((pos1 == 15) && (digitalRead(14) == LOW)) {
    delay(130);
    display.clearDisplay();
    mode = MODE_TORCH_R_STEP1;
  }
  if ((pos1 == 30) && (digitalRead(14) == LOW)) {
    delay(130);
    display.clearDisplay();
    mode = MODE_LASER;
  }
  if ((pos1 == 45) && (digitalRead(14) == LOW)) {
    mode = MODE_MAIN_MENU;
    delay(130);
    display.clearDisplay();
    pos1 = 0;
  }
  if (pos1 > 45) {
    pos1 = 0;
  }
}

void resetFlappyState() {
  died = false;
  started = false;
  started2 = false;
  score = 0;
  sc = 0;
  startTime = millis();
  startTime2 = millis();
}

void handleWhiteTorchStep1() {
  ala();
  blacke();
  brightnessone();
  display.display();
  analogWrite(3, 75);
  if (digitalRead(14) == LOW) {
    delay(130);
    mode = MODE_TORCH_W_STEP2;
  }
}

void handleWhiteTorchStep2() {
  ala();
  blacke();
  brightnesstwo();
  display.display();
  analogWrite(3, 150);
  if (digitalRead(17) == LOW) {
    delay(130);
    mode = MODE_TORCH_W_STEP3;
  }
}

void handleWhiteTorchStep3() {
  ala();
  blacke();
  display.drawBitmap(47, 20, brightness3, 32, 32, BLACK);
  display.display();
  analogWrite(3, 255);
  if (digitalRead(16) == LOW) {
    delay(130);
    analogWrite(3, 0);
    mode = MODE_TORCH_MENU;
  }
}

void handleLaserMode() {
  ala();
  blacke();
  display.drawBitmap(47, 20, brightness3, 32, 32, BLACK);
  display.display();
  digitalWrite(4, HIGH);
  if (digitalRead(16) == LOW) {
    delay(130);
    digitalWrite(4, LOW);
    mode = MODE_TORCH_MENU;
  }
}

void handleRedTorchStep1() {
  ala();
  blacke();
  brightnessone();
  display.display();
  analogWrite(5, 75);
  if (digitalRead(14) == LOW) {
    delay(130);
    mode = MODE_TORCH_R_STEP2;
  }
}

void handleRedTorchStep2() {
  ala();
  blacke();
  brightnesstwo();
  display.display();
  analogWrite(5, 150);
  if (digitalRead(17) == LOW) {
    delay(130);
    mode = MODE_TORCH_R_STEP3;
  }
}

void handleRedTorchStep3() {
  blacke();
  ala();
  display.drawBitmap(47, 20, brightness3, 32, 32, BLACK);
  display.display();
  analogWrite(5, 255);
  if (digitalRead(16) == LOW) {
    delay(130);
    analogWrite(5, 0);
    mode = MODE_TORCH_MENU;
  }
}

void handleSleepMode() {
  ala();
  display.clearDisplay();
  display.display();
  if (digitalRead(16) == LOW) {
    delay(130);
    display.clearDisplay();
    mode = MODE_CLOCK;
  }
}

void handleGamesMenu() {
  ala();
  display.setTextColor(WHITE, BLACK);
  display.setTextSize(1);
  display.setCursor(40, 0);
  display.println("<Games>");
  display.setTextSize(2);
  display.setTextColor(BLACK, WHITE);
  display.setCursor(0, 10);
  display.println("Flappy man");
  display.display();
  if (digitalRead(16) == LOW) {
    display.clearDisplay();
    mode = MODE_GAME_FLAPPY;
  }
}

void handleFlappyGame() {
  ala();
  Run();
}

// Alarm set / edit menu
void handleAlarmMenu() {
  alarms();

  if ((al == 0) && (digitalRead(14) == LOW)) {
    delay(130);
    display.clearDisplay();
    zero++;
  }
  if ((al == 1) && (digitalRead(14) == LOW)) {
    delay(130);
    display.clearDisplay();
    six++;
  }
  if ((al == 0) && (digitalRead(16) == LOW)) {
    delay(130);
    display.clearDisplay();
    al = 1;
  }
  if ((al == 1) && (digitalRead(17) == LOW)) {
    delay(130);
    display.clearDisplay();
    al = 2;
    pos10 = 0;
  }
  if ((al == 2) && (digitalRead(16) == LOW)) {
    delay(130);
    display.clearDisplay();
    al = 3;
    pos10 = 39;
  }
  if ((al == 3) && (digitalRead(17) == LOW)) {
    delay(130);
    display.clearDisplay();
    al = 4;
    pos10 = 72;
    alarms();
  }
  if ((al == 4) && (digitalRead(17) == LOW)) {
    delay(130);
    display.clearDisplay();
    al = 0;
    pos10 = -20;
  }
  if ((pos10 == 72) && (digitalRead(14) == LOW)) { // Save
    delay(130);
    display.clearDisplay();
    ad = 1;
    pos10 = -20;
    al = 0;
    mode = MODE_MAIN_MENU;
  }
  if (zero > 24) {
    display.clearDisplay();
    display.display();
    zero = 0;
    gpos = 17;
    gpos2 = 35;
  }
  if (six > 59) {
    display.clearDisplay();
    display.display();
    six = 0;
    gpos3 = 61;
    gpos4 = 79;
  }
  if ((pos10 == 0) && (digitalRead(14) == LOW)) { // Back
    display.clearDisplay();
    mode = MODE_MAIN_MENU;
    pos10 = -20;
    al = 0;
  }
  if ((pos10 == 39) && (digitalRead(14) == LOW)) { // OFF
    display.clearDisplay();
    mode = MODE_MAIN_MENU;
    six = 0;
    zero = 0;
    gpos = 17;
    gpos2 = 35;
    gpos3 = 61;
    gpos4 = 79;
    al = 0;
    ad = 0;
    pos10 = -20;
  }
  if (zero > 9) {
    display.clearDisplay();
    gpos = -20;
    gpos2 = 17;
    alarms();
    display.display();
  }
  if (six > 9) {
    display.clearDisplay();
    gpos3 = -20;
    gpos4 = 61;
    alarms();
    display.display();
  }
}

void handleAlarmRinging() {
  display.clearDisplay();
  display.drawBitmap(50, 20, alarm, 32, 32, 1);
  display.setTextColor(color);
  display.setTextSize(1);
  display.setCursor(20, 0);
  display.println("Alarm going off");
  display.display();
  analogWrite(10, soundf);
  analogWrite(9, soundg);

  if (digitalRead(16) == LOW) {
    display.clearDisplay();
    display.display();
    ad = 0;
    mode = MODE_CLOCK;
    analogWrite(10, 0);
    analogWrite(9, 0);
  }
}


void stope() {
  if (digitalRead(16) == LOW) {
    delay(130);
    display.display();
    mode = MODE_MAIN_MENU;
  }
  if (digitalRead(17) == LOW) {
    display.clearDisplay();
    delay(130);
    display.display();
    stsec = 0;
    stmin = 0;
    ipos = 0;
    ipos2 = 19;
    ipos3 = 46;
    ipos4 = 65;
  }
}

void alarms() {
  display.setTextSize(1);
  display.setCursor(35, 0);
  display.println("<Alarm>");
  display.setTextSize(3);
  display.setCursor(gpos, 23);
  display.println("0");
  display.setCursor(gpos2, 23);
  display.println(zero);
  display.setCursor(48, 23);
  display.println(":");
  display.setCursor(gpos3, 23);
  display.println("0");
  display.setCursor(gpos4, 23);
  display.println(six);
  display.setTextSize(1);
  display.setCursor(pos10, 55);
  display.println(">");
  display.setCursor(12, 55);
  display.println("back");
  display.setCursor(47, 55);
  display.println("OFF");
  display.setCursor(80, 55);
  display.println("Save");
  display.display();
}

void menu_dis() {
  menu();
  display.drawBitmap(dpos,  20, brightness3, 32, 32, 1);
  display.drawBitmap(dpos2, 20, screencolor, 32, 32, 1);
  display.drawBitmap(dpos3, 20, rotates,    32, 32, 1);
  display.drawBitmap(dpos4, 20, exits,      32, 32, 1);
  display.display();
}

void menu() {
  display.clearDisplay();
  display.setTextColor(color);
  display.setTextSize(1);
  display.setCursor(25, 0);
  display.println("<MAIN MENU>");
  display.drawBitmap(25, 17, toparrow,   36, 8, color);
  display.drawBitmap(25, 46, bottomarrow,36, 8, color);
}

void displayStopWatch() {
  display.setTextSize(3);
  display.setTextColor(color);
  display.setCursor(ipos, 20);
  display.println("0");
  display.setCursor(ipos2, 20);
  display.println(stmin);
  display.setCursor(33, 20);
  display.println(":");
  display.setCursor(ipos3, 20);
  display.println("0");
  display.setCursor(ipos4, 20);
  display.println(stsec);
  display.setTextSize(1);
  display.setCursor(85, 0);
  display.println("Back");
  display.setCursor(85, 55);
  display.println("Reset");
  display.display();
}

void pauseStopwatch() {
  display.setTextSize(1);
  display.setTextColor(color);
  display.setCursor(90, 30);
  display.println("Pause");
  display.display();
}

void stopwatch3() {
  display.setTextSize(1);
  display.setTextColor(color);
  display.setCursor(90, 30);
  display.println("Con");
  display.display();
}

void displayGameOver(void) {
  display.clearDisplay();
  display.setTextSize(2);
  display.setTextColor(WHITE, BLACK);
  display.setCursor(10, 0);
  display.println("Game Over");
  display.setTextSize(3);
  display.setCursor(40, 22);
  display.println(sc);
  display.setTextColor(BLACK, WHITE);
  display.setCursor(0, 47);
  display.println("Return");
  display.display();
  if (digitalRead(14) == LOW) {
    resetFlappyState();
    display.clearDisplay();
    mode = MODE_MAIN_MENU;
  }
}

void blacke() {
  display.fillRect(0, 0, 128, 75, 1);
}

void Run() {
  boolean pressed = !digitalRead(16);
  display.setCursor(40, 0);

  if (pressed) {
    if (!started) startTime2 = millis();
    started = true;
  }

  float timef = (millis() - startTime2);
  float timf = timef * 2;
  if (timef > 50000) timef = timf;
  else timef *= 1 + timef / 200000;
  score = timef / 100;

  if (started) {
    int jumP = jump(pressed && started2 && timef > 300, 35, 1.6);
    if (started2 && timef < 300) display.drawBitmap(30, 48, player, 16, 16, 1);
    int move = 128 - ((int)(timef / 7)) % 144;
    boolean collisionx = move <= 48 - jumP && 20 + move >= 48 - jumP;
    display.drawBitmap(30, 48 - jumP, player, 16, 16, 1);
    display.fillRect(move, 46, 16, 16, 1);
    started2 = true;
    if (collisionx && jumP < 16) died = true;
    display.println(score);
  } else {
    display.setTextSize(2);
    display.setTextColor(color);
    display.setCursor(40, 0);
    display.println("play");
    display.drawBitmap(30, 48, player, 16, 16, 1);
  }

  if (!died) sc = score;
  if (died) displayGameOver();

  if (!died) {
    display.display();
    display.clearDisplay();
  }
}

int jump(boolean trigjump, int height, float speed) {
  long time = (millis() - startTime);
  if (trigjump && !jumping) {
    jumping = true;
    startTime = millis();
  }
  time *= speed;
  if (time >= 1000) {
    jumping = false;
  }
  if (jumping) {
    float j = height * (float)sin(((PI * 2) / 1000) * (time / 2));
    return (int)j;
  } else return 0;
}

void brightnessone() {
  display.drawBitmap(47, 20, brightness1, 32, 32, BLACK);
}

void brightnesstwo() {
  display.drawBitmap(47, 20, brightness2, 32, 32, BLACK);
}

void tim() {
  delay(130);
  display.clearDisplay();
  DateTime now = rtc.now();
  display.setTextColor(color);
  display.setTextSize(3);
  display.setCursor(ghpos, 21);
  display.println("0");
  display.setCursor(ghpos2, 22);
  display.println(hours = now.hour());
  display.setCursor(ghpos3, 21);
  display.println("0");
  display.setCursor(ghpos4, 21);
  display.println(minutes = now.minute());
  display.setTextSize(2);
  display.setCursor(ghpos5, 29);
  display.println(seconds = now.second());
  int te = 25;
  display.setCursor(75, 50);
  display.println(te);
  display.setCursor(108, 50);
  display.println("C");
  display.setTextSize(1);
  int days = now.day();
  int months = now.month();
  int years = now.year();
  display.setCursor(40, 0);
  display.println(daysOfTheWeek[now.dayOfTheWeek()]);
  display.setCursor(35, 10);
  display.println(days);
  display.setCursor(46, 10);
  display.println("-");
  display.setCursor(52, 10);
  display.println(months);
  display.setCursor(65, 10);
  display.println(years);
  display.setTextSize(1);
  display.setCursor(100, 50);
  display.println("o");
  display.drawRect(0, 53, 18, 10, 1);
  display.drawRect(17, 56, 4, 4, 1);
  display.fillRect(2, 55, 14, 6, 1);
  display.drawBitmap(0, 0, cloud, 12, 10, color);
  display.display();

  if (hours < 10) {
    ghpos = 17;
    ghpos2 = 35;
  }
  if (ad == 1) {
    display.drawBitmap(50, 53, small, 10, 10, color);
    display.display();
  }
  if (minutes < 10) {
    ghpos3 = 61;
    ghpos4 = 79;
  }
  if (hours >= 10) {
    ghpos = -20;
    ghpos2 = 17;
  }
  if (minutes >= 10) {
    ghpos3 = -20;
    ghpos4 = 61;
  }
}

void dis() {
  display.setTextColor(color);
  display.setTextSize(3);
  display.setCursor(47, 24);
  display.println(":");
  display.display();
}

void ala() {
  DateTime now = rtc.now();
  int hours = now.hour();
  int minutes = now.minute();
  if ((ad == 1) && (zero == hours) && (six == minutes)) {
    display.clearDisplay();
    display.display();
    mode = MODE_ALARM_RING;
  }
}

void speakers() {
  display.setTextColor(color);
  display.setTextSize(1);
  display.setCursor(40, 0);
  display.println("<Volume>");
  display.setCursor(12, 10);
  display.println("Mute");
  display.setCursor(12, 20);
  display.println("Low");
  display.setCursor(12, 30);
  display.println("Medium");
  display.setCursor(12, 40);
  display.println("High");
  display.setCursor(12, 50);
  display.println("Back");
  display.display();
}

void sleep() {
  if (digitalRead(14) == LOW) {
    delay(160);
    display.clearDisplay();
    mode = MODE_SLEEP;
  }
}
